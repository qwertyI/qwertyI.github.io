<!DOCTYPE html>
<html lang="zh">

<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="https://qwertyI.github.io/my-test-1.html" />

    <title>  Ning's Blog &mdash; selenium 测试小技巧
</title>




    <link rel="stylesheet" href="https://qwertyI.github.io/theme/css/style.css">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <meta name="author" content="Ning">
    <meta name="description" content="Test">
  <meta name="tags" contents="python, test, ">
</head>

<body>
<header class="header">
  <div class="container">
    <div class="header-inner">
      <h1 class="header-name">
        <a class="nodec" href="https://qwertyI.github.io">Ning's Blog</a>
      </h1>
      <h3 class="header-text"></h3>
      <ul class="header-menu list-inline">
          <li><a class="nodec icon-mail-alt" href="mailto:727665171@qq.com"></a></li>
          <li><a class="nodec icon-github" href="https://github.com/qwertyI"></a></li>
      </ul>
    </div>
  </div>
</header> <!-- /.header -->  <div class="container">
  <div class="post full-post">
    <h1 class="post-title">
      <a href="/my-test-1.html" title="Permalink to selenium 测试小技巧">selenium 测试小技巧</a>
    </h1>
    <ul class="list-inline">
      <li class="post-date">
        <a class="text-muted" href="/my-test-1.html" title="2016-11-09T10:20:00">三 09 十一月 2016</a>
      </li>
      <li class="muted">&middot;</li>
      <li class="post-category">
        <a href="https://qwertyI.github.io/category/python.html">Python</a>
      </li>
        <li class="muted">&middot;</li>
        <li>
            <a href="https://qwertyI.github.io/tag/python.html">python</a>,             <a href="https://qwertyI.github.io/tag/test.html">test</a>        </li>
    </ul>
    <div class="post-content">
      <p><strong>设置下载文件的存储位置</strong></p>
<p>对于有下载文件并且读取下载内容来确定测试结果的小伙伴来说，这很实用！</p>
<div class="highlight"><pre><span></span>options = webdriver.ChromeOptions()
pref = {&quot;download.default_directory&quot;: your_download_path}
options.add_experimental_option(&quot;prefs&quot;, pref)
</pre></div>


<p><strong>获取当前case名称</strong></p>
<p>当一个测试类中有N个测试case时，无法区分当前测试进行到哪个case有时会很难受！打印出来就好了！</p>
<div class="highlight"><pre><span></span>print &#39;current testcase : {0}&#39;.format(unittest.TestCase.id(self))
&gt;&gt;&gt; current testcase : test1.your_test_class.your_test_case
</pre></div>


<p><strong>can't find element 解决</strong></p>
<p>寻找同一个元素两次，找到了继续执行，没有找到则寻找第二次，仍旧没找到则报错！
预防一个元素因为页面加载原因无法找到而导致的失败</p>
<p>使用ActionChains寻找元素，防止发生找到元素，但是无法点击该点的错误！</p>
<div class="highlight"><pre><span></span>def action_click(self, name, value):
    attempts = 0
    while attempts &lt; 2:
        try:
            self.driver.implicitly_wait(wait_time)
            ele = self.driver.find_element(by=name, value=value)
            ActionChains(self.driver).move_to_element(ele).click().perform()
            time.sleep(sleep_time)
            break
        except Exception:
            attempts += 1
            if attempts == 2:
                print &#39;can\&#39;t find correct WebElement, please check it!&#39;
</pre></div>


<p><strong>点击动态生成的按钮</strong></p>
<p>测试过程中，有时会碰到右键点击才会出现的菜单栏，因为是动态生成的，有些甚至不会有Html信息，不过不用着急，selenium自有办法对付：</p>
<div class="highlight"><pre><span></span>action = ActionChains(self.driver.driver)
action.move_by_offset(500, 500).context_click().send_keys(Keys.ARROW_DOWN).send_keys(Keys.RETURN)
</pre></div>


<p>此类动态生成的菜单，多有使用按键操作的方法！此时只需要调用Keys类中的各种键盘按键就可以操作选中所需的按钮！最后RETURN实现操作！</p>
<p><strong>选择文件</strong></p>
<p>上传文件时，如果Html贴心的给你设置了上传路径的Input标签，那就可以很舒服的使用sendkeys，将路径键入之后就可以了！但是有时前端工程师并不那么的贴心（对，我说的就是谷歌的前端工程师），他会使用各种高端技巧来生成文件路径，其中有一种叫动态生成，他会调用win/ubuntu等系统的文件选择界面，选中后动态生成文件路径（懵逼脸）！这时就需要用到额外的包类：pywinauto。。此功能仅限win系统使用。</p>
<div class="highlight"><pre><span></span>app = pywinauto.application.Application()
time.sleep(win_sleep_time)
main_window = app[u&#39;Open&#39;]
ctrl = main_window[u&#39;Edit&#39;]
main_window.SetFocus()
ctrl.Click()
time.sleep(win_sleep_time)
ctrl.TypeKeys(file_path)
time.sleep(win_sleep_time)
ctrl_bis = main_window[u&#39;OpenButton&#39;]  # open file button
time.sleep(win_sleep_time)
</pre></div>


<p>具体而言，就是首先main_window = app[u'Open']定位到你Open界面，然后定位都输入栏，键入路径之后点击打开按钮完成选择文件操作，一般这种上传文件的方式打开按钮包含了上传功能。</p>
<hr />
    </div>
  </div>
  <hr class="separator">
  <div class="col-md-8 col-md-offset-2">
  </div>
  </div>
<footer class="footer">
  <div class="container">
    <p class="text-center">
      Ning, <a href="" target="_blank"></a> unless otherwise noted.
    </p>
    <div class="text-center">
      Generated by <a href="http://getpelican.com" target="_blank">Pelican</a> with the <a href="http://github.com/nairobilug/pelican-alchemy">alchemy</a> theme.
    </div>
  </div>
</footer> <!-- /.footer -->
  <script src="https://qwertyI.github.io/theme/js/jquery.min.js"></script>
  <script src="https://qwertyI.github.io/theme/js/bootstrap.min.js"></script>
</body> <!-- 42 -->

</html>